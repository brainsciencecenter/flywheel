import "id2ProjectLabels" as $ProjectId2Labels;
import "id2SubjectLabels" as $SubjectId2Labels;

      ._id as $SessionUid
    | .label as $SessionLabel 
    | .parents.group as $GroupLabel 
    | $ProjectId2Labels::ProjectId2Labels[][.parents.project] as $ProjectLabel 
    | $SubjectId2Labels::SubjectId2Labels[][.parents.subject] as $SubjectLabel 
    | .acquisitions[] 
		| ._id as $AcquisitionUid
		| .label as $AcquisitionLabel 
                | .timestamp as $TimeStamp
		| .files[] 
			| (if .info.ImageType then .info.ImageType | join(":") else "" end) as $ImageType 
			| (if .classification.Measurement then .classification.Measurement | join(":") else "" end) as $Measurement 
                        | ([ $TimeStamp,
			    $SessionUid,
			    $AcquisitionUid,
			    $AcquisitionLabel,
			    "\($GroupLabel)/\($ProjectLabel)/\($SubjectLabel)/\($SessionLabel)/\($AcquisitionLabel)/files/\(.name)",
			     $ImageType,
			    ._id, 
			    $Measurement
			   ]) | @csv




